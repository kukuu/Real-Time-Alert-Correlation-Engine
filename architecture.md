# Data Flow Architecture

 ```

┌─────────────────────────────────────────────────────────────────────────────┐
│                              DATA PRODUCERS                                 │
│  ┌─────────────┐  ┌──────────────┐  ┌─────────────┐  ┌─────────────────┐    │
│  │   911 Calls │  │ Social Media │  │   Sensors   │  │  Other Sources  │    │
│  │   (REST/    │  │  (Twitter,   │  │ (IoT, CCTV, │  │ (BOLO, Patrol,  │    │
│  │   Webhook)  │  │   Facebook)  │  │  Traffic)   │  │   CAD, NCIC)    │    │
│  └──────┬──────┘  └──────┬───────┘  └──────┬──────┘  └────────┬────────┘    │
└─────────┼─────────────────┼─────────────────┼──────────────────┼───────────-┘
          │                 │                 │                  │
          ▼                 ▼                 ▼                  ▼
┌─────────┼─────────────────┼─────────────────┼──────────────────┼───────────┐
│     ┌───▼─────┐       ┌───▼─────┐       ┌───▼─────┐        ┌──▼──────┐     │
│     │  911    │       │ Social  │       │ Sensor  │        │ Other   │     │
│     │Ingestor │       │ Media   │       │Ingestor │        │Ingestor │     │
│     │ Service │       │Service  │       │ Service │        │ Service │     │
│     │(Spring  │       │(Quarkus)│       │(Spring  │        │(Spring  │     │
│     │ Cloud   │       │         │       │ Cloud   │        │ Cloud   │     │
│     │ Stream) │       │         │       │ Stream) │        │ Stream) │     │
│     └────┬────┘       └────┬────┘       └────┬────┘        └────┬────┘     │
│          │                  │                 │                 │          │
│          └──────────────────┼─────────────────┼─────────────────┘          │
│                             │                 │                            │
└─────────────────────────────┼─────────────────┼───────────────────────────-┘
                              ▼                 ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                             KAFKA CLUSTER (TLS)                             │
│                        ┌─────────────────────────┐                          │
│                        │  Topics with Avro Schema│                          │
│                        │ ┌─────────────────────┐ │                          │
│  ┌─────────────────────┼►│  raw-alerts         │ │                          │
│  │                     │ │  (Partitioned by    │ │                          │
│  │                     │ │   jurisdiction)     │ │                          │
│  │                     │ └─────────────────────┘ │                          │
│  │                     │ ┌─────────────────────┐ │                          │
│  │                     │ │  normalized-alerts  │ │                          │
│  │                     │ │  (Enriched, cleaned)│ │                          │
│  │                     │ └─────────────────────┘ │                          │
│  │                     │ ┌─────────────────────┐ │                          │
│  │                     │ │  correlated-events  │ │                          │
│  │                     │ │  (ML/rule outputs)  │ │                          │
│  │                     │ └─────────────────────┘ │                          │
│  │                     │ ┌─────────────────────┐ │                          │
│  │                     │ │  incidents          │ │                          │
│  │                     │ │  (Confirmed events) │ │                          │
│  │                     │ └─────────────────────┘ │                          │
│  │                     └─────────────────────────┘                          │
└──┼─────────────────────────────────────────────────────────────────────────-┘
   │
   ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                       STREAM PROCESSING & CORRELATION                       │
│  ┌──────────────────────────────────────────────────────────────────────┐   │
│  │                    Correlation Engine (Quarkus)                      │   │
│  │  ┌─────────────┐  ┌──────────────┐  ┌────────────────────────────┐   │   │
│  │  │  Geospatial │  │  Rule Engine │  │  Machine Learning          │   │   │
│  │  │  Clustering │  │  (Drools)    │  │  (TensorFlow Serving)      │   │   │
│  │  └──────┬──────┘  └──────┬───────┘  └────────────┬───────────────┘   │   │
│  │         │                 │                       │                  │   │
│  │         └─────────────────┼───────────────────────┘                  │   │
│  │                           ▼                                          │   │
│  │                  ┌──────────────┐                                    │   │
│  │                  │ Incident     │                                    │   │
│  │                  │ Detection    │                                    │   │
│  │                  │ & Scoring    │                                    │   │
│  │                  └──────┬───────┘                                    │   │
│  └─────────────────────────┼────────────────────────────────────────────┘   │
│                            │                                                │
└────────────────────────────┼────────────────────────────────────────────────┘
                             │
                             ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                          DATA STORAGE & SERVICES                            │
│  ┌─────────────────┐  ┌─────────────────┐  ┌────────────────────────────┐   │
│  │   PostgreSQL    │  │   MongoDB       │  │   Redis Cluster            │   │
│  │   (Relational   │  │   (Document     │  │   (Caching & Session       │   │
│  │    Data, Users, │  │    Store,       │  │    Management,             │   │
│  │    Audit Logs)  │  │    Alerts,      │  │    Real-time counters)     │   │
│  │                 │  │    Incidents)   │  │                            │   │
│  └────────┬────────┘  └────────┬────────┘  └────────────┬───────────────┘   │
│           │                    │                        │                   │
│           └────────────────────┼────────────────────────┘                   │
│                                │                                            │
│                       ┌────────▼────────┐                                   │
│                       │   Alert Service │                                   │
│                       │   (Spring Boot) │                                   │
│                       │   - REST API    │                                   │
│                       │   - WebSocket   │                                   │
│                       │   - Security    │                                   │
│                       └────────┬────────┘                                   │
└────────────────────────────────┼───────────────────────────────────────────-┘
                                 │
                                 ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                         API GATEWAY & SECURITY LAYER                        │
│  ┌──────────────────────────────────────────────────────────────────────┐   │
│  │                  Spring Cloud Gateway (Edge Service)                 │   │
│  │  ┌─────────────┐  ┌──────────────┐  ┌────────────────────────────┐   │   │
│  │  │  Rate       │  │  JWT         │  │  Request/Response          │   │   │
│  │  │  Limiting   │  │  Validation  │  │  Transformation            │   │   │
│  │  └──────┬──────┘  └──────┬───────┘  └────────────┬───────────────┘   │   │
│  │         │                 │                       │                  │   │
│  │         └─────────────────┼───────────────────────┘                  │   │
│  │                           ▼                                          │   │
│  │                  ┌──────────────┐                                    │   │
│  │                  │   Circuit    │                                    │   │
│  │                  │   Breaker    │                                    │   │
│  │                  │   & Retry    │                                    │   │
│  │                  └──────┬───────┘                                    │   │
│  └─────────────────────────┼────────────────────────────────────────────┘   │
│                            │                                                │
└────────────────────────────┼────────────────────────────────────────────────┘
                             │ HTTPS/WSS (TLS 1.3)
                             ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                         REACT FRONTEND APPLICATION                          │
│  ┌──────────────────────────────────────────────────────────────────────┐   │
│  │                           Browser                                    │   │
│  │  ┌─────────────┐  ┌──────────────┐  ┌────────────────────────────┐   │   │
│  │  │ Service     │  │  Context     │  │  WebSocket                 │   │   │
│  │  │ Workers     │  │  Providers   │  │  Manager                   │   │   │
│  │  │ (Caching,   │  │  (Auth,      │  │  (Real-time                │   │   │
│  │  │  Offline)   │  │   Alerts,    │  │   updates,                 │   │   │
│  │  │             │  │   Audit)     │  │   reconnection)            │   │   │
│  │  └──────┬──────┘  └──────┬───────┘  └────────────┬───────────────┘   │   │
│  │         │                 │                      │                   │   │
│  │         └─────────────────┼──────────────────────┘                   │   │
│  │                           ▼                                          │   │
│  │                  ┌──────────────┐                                    │   │
│  │                  │   UI         │                                    │   │
│  │                  │   Components │                                    │   │
│  │                  │   (React)    │                                    │   │
│  │                  └──────┬───────┘                                    │   │
│  │                         │                                            │   │
│  │                  ┌──────▼───────┐                                    │   │
│  │                  │   Virtual    │                                    │   │
│  │                  │     DOM      │                                    │   │
│  │                  │   Updates    │                                    │   │
│  │                  └──────────────┘                                    │   │
│  └──────────────────────────────────────────────────────────────────────┘   │
│                                  │                                          │
│  ┌───────────────────────────────▼──────────────────────────────┐           │
│  │                    User Interaction                          │           │
│  │  • View real-time alerts on map                              │           │
│  │  • Filter by location/time/priority                          │           │
│  │  • Acknowledge incidents                                     │           │
│  │  • Generate reports                                          │           │
│  │  • Administer users/system                                   │           │
│  └────────────────────────────────────────────────────────────--┘           │
└───────────────────────────────────────────────────────────────────────────--┘

```
